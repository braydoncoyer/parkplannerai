---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Header from '../../components/layout/Header.astro';
import ParkDetailPage from '../../components/park-detail/ParkDetailPage';

export const prerender = false;

const { id } = Astro.params;

// Fetch park info from the main parks list
const parksResponse = await fetch(`https://queue-times.com/parks.json`);
const parksData = await parksResponse.json();

// Find the park in the response
let parkName = 'Theme Park';
let parkOperator = '';

for (const group of parksData) {
  const park = group.parks?.find((p: { id: number }) => p.id === Number(id));
  if (park) {
    parkName = park.name;
    parkOperator = group.name.includes('Disney') ? 'Disney' : 'Universal';
    break;
  }
}
---

<BaseLayout title={`${parkName} | Live Wait Times`}>
  <Header />
  <main>
    <ParkDetailPage
      parkId={id!}
      parkName={parkName}
      operator={parkOperator}
      client:load
    />
  </main>
</BaseLayout>

<style is:global>
  /* Reset any conflicting styles from old park detail page */
  main {
    background: transparent;
  }
</style>
